(function(){"use strict";var t={4514:function(t,e,i){var n=i(9963),s=i(6252);const o={id:"app"};function a(t,e,i,n,a,r){const l=(0,s.up)("TitleHeader"),c=(0,s.up)("CreateImage"),d=(0,s.up)("CanvasField");return(0,s.wg)(),(0,s.iD)("div",o,[(0,s.Wm)(l),(0,s.Wm)(c,{onMyClick:r.emitData},null,8,["onMyClick"]),(0,s.Wm)(d,{results:a.results},null,8,["results"])])}var r=i(3577);const l=t=>((0,s.dD)("data-v-33cfcf35"),t=t(),(0,s.Cn)(),t),c={class:"input-area",for:"input-video"},d={key:0,controls:"",id:"video"},h=["src"],u=l((()=>(0,s._)("span",null,"Capture this moment!!!",-1))),f=[u],p=l((()=>(0,s._)("h3",{class:"wait"},"Wait about 5 seconds...",-1)));function v(t,e,i,n,o,a){return(0,s.wg)(),(0,s.iD)("div",null,[(0,s._)("label",c,(0,r.zw)(o.isLoading?"Loading...":"Upload Video"),1),(0,s._)("input",{id:"input-video",type:"file",accept:"video/mp4,video/x-m4v",onChange:e[0]||(e[0]=(...t)=>a.handleFileSelect&&a.handleFileSelect(...t))},null,32),o.src?((0,s.wg)(),(0,s.iD)("video",d,[(0,s._)("source",{src:o.src,type:'video/mp4; codecs="avc1.42E01E, mp4a.40.2"'},null,8,h)])):(0,s.kq)("",!0),(0,s._)("a",{class:"btn uploadbtn",onClick:e[1]||(e[1]=t=>a.onUploadImage())},f),p])}i(7658);var g=i(8945);const x="http://127.0.0.1:5000";var _={data(){return{src:null,image:[],uploadedImage:"",results:[],time:0,isLoading:!1}},methods:{handleFileSelect(t){this.src=null,this.selected=0;const e=t.target.files[0];if(!e||!e.type.match("video/*"))return;const i=new FileReader;i.onload=t=>{this.src=t.target.result,this.isLoading=!1},i.readAsDataURL(e),this.isLoading=!0},onUploadImage(){let t=this;this.image=[];const e=document.createElement("canvas"),i=e.getContext("2d"),n=document.getElementById("video");e.width=n.videoWidth,e.height=n.videoHeight,this.time=n.currentTime,n.pause(),i.drawImage(n,0,0,n.videoWidth,n.videoHeight),this.image.push(e.toDataURL("image/png"));var s=new FormData;s.append("image",this.image),g.Z.post(`${x}/detect`,s).then((function(e){t.results=e.data.results;for(const i of t.results)console.log(i);t.$emit("my-click",t.results)}))}}},b=i(3744);const m=(0,b.Z)(_,[["render",v],["__scopeId","data-v-33cfcf35"]]);var w=m;const k={class:"title"},y=(0,s._)("h1",{class:"title-txt"},"Tactical Board Generater",-1),M=(0,s._)("div",{class:"desc"},[(0,s._)("h2",null,"試合映像からシーンを切り取り、作戦ボードに表示させます。")],-1),C=[y,M];function I(t,e){return(0,s.wg)(),(0,s.iD)("div",k,C)}const S={},F=(0,b.Z)(S,[["render",I]]);var D=F;const W=t=>((0,s.dD)("data-v-e5c65264"),t=t(),(0,s.Cn)(),t),E={class:"container"},R={id:"tool-area"},B=W((()=>(0,s._)("label",{class:"radio-inline__label",for:"move-arc-button"}," DRAG ",-1))),O=W((()=>(0,s._)("label",{class:"radio-inline__label",for:"pen-black-button"}," BLACK ",-1))),L=W((()=>(0,s._)("label",{class:"radio-inline__label",for:"pen-red-button"}," RED ",-1))),A=W((()=>(0,s._)("label",{class:"radio-inline__label",for:"pen-blue-button"}," BLUE ",-1))),T=W((()=>(0,s._)("label",{class:"radio-inline__label",for:"eraser-button"}," ERASE ",-1))),X=W((()=>(0,s._)("label",{class:"radio-inline__label",for:"clear-button"}," CLEAR ",-1)));function Y(t,e,i,n,o,a){return(0,s.wg)(),(0,s.iD)("div",E,[(0,s._)("canvas",{id:"myCanvas",class:(0,r.C_)({eraser:"eraser"===o.canvasMode}),ref:"myCanvas",onMousedown:e[0]||(e[0]=(...t)=>a.dragStart&&a.dragStart(...t)),onMouseup:e[1]||(e[1]=(...t)=>a.dragEnd&&a.dragEnd(...t)),onMouseout:e[2]||(e[2]=(...t)=>a.dragEnd&&a.dragEnd(...t)),onMousemove:e[3]||(e[3]=(...t)=>a.draw&&a.draw(...t))},null,34),(0,s._)("div",R,[(0,s._)("fieldset",null,[(0,s._)("input",{id:"move-arc-button",onClick:e[4]||(e[4]=(...t)=>a.moveArc&&a.moveArc(...t)),class:"radio-inline__input",type:"radio",checked:"checked"}),B,(0,s._)("input",{id:"pen-black-button",onClick:e[5]||(e[5]=(...t)=>a.penBlack&&a.penBlack(...t)),class:"radio-inline__input",type:"radio"}),O,(0,s._)("input",{id:"pen-red-button",onClick:e[6]||(e[6]=(...t)=>a.penRed&&a.penRed(...t)),class:"radio-inline__input",type:"radio"}),L,(0,s._)("input",{id:"pen-blue-button",onClick:e[7]||(e[7]=(...t)=>a.penBlue&&a.penBlue(...t)),class:"radio-inline__input",type:"radio"}),A,(0,s._)("input",{id:"eraser-button",onClick:e[8]||(e[8]=(...t)=>a.eraser&&a.eraser(...t)),class:"radio-inline__input",type:"radio"}),T,(0,s._)("input",{id:"clear-button",onClick:e[9]||(e[9]=(...t)=>a.clear&&a.clear(...t)),class:"radio-inline__input",type:"radio"}),X])])])}var P={props:["results"],data(){return{ratio:1,dx:0,dy:0,isMove:!1,beforeMouseX:null,beforeMouseY:null,coords:[],selectIdx:0,radius:window.innerWidth/150,field_w:.6*window.innerWidth,field_h:.39*window.innerWidth,weightNum:5,stroke:"black",canvas:null,context:null,canvasMode:"penBlack"}},watch:{results:function(){this.coords=this.results,this.canvasMode="drag",this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},coords:function(){for(let t=0;t<this.coords.length;t++)this.context.beginPath(),this.context.arc(parseInt(this.coords[t].x*this.field_w/115),parseInt(this.coords[t].y*this.field_h/75),this.radius,0,2*Math.PI),this.context.fillStyle=this.coords[t].color,this.context.fill(),this.context.lineWidth=2,this.context.strokeStyle=this.stroke,this.context.stroke()}},mounted(){this.canvas=document.querySelector("#myCanvas"),this.context=this.canvas.getContext("2d"),this.context.lineCap="round",this.context.lineCap="round",this.canvas.width=this.field_w,this.canvas.height=this.field_h,this.context.lineWidth=this.weightNum,this.context.strokeStyle=this.stroke,console.log("field-width : ",this.field_w),console.log("field-height : ",this.field_h)},methods:{draw:function(t){let e=t.offsetX,i=t.offsetY;if(this.isDrag)if("drag"==this.canvasMode){if(this.context.clearRect(0,0,this.canvas.width,this.canvas.height),!this.isMove)return;var n=e*this.ratio+this.dx,s=i*this.ratio+this.dy,o=0,a=0;this.beforeMouseX&&this.beforeMouseY&&(o=n-this.beforeMouseX,a=s-this.beforeMouseY),this.beforeMouseX=n,this.beforeMouseY=s;var r=o/this.field_w*115+Number(this.coords[this.selectIdx].x),l=a/this.field_h*75+Number(this.coords[this.selectIdx].y);r>0&&(this.coords[this.selectIdx].x=r),l>0&&(this.coords[this.selectIdx].y=l);for(let t=0;t<this.coords.length;t++)this.context.beginPath(),this.context.arc(parseInt(this.coords[t].x*this.field_w/115),parseInt(this.coords[t].y*this.field_h/75),this.radius,0,2*Math.PI),this.context.fillStyle=this.coords[t].color,this.context.fill(),this.context.lineWidth=2,this.context.strokeStyle=this.stroke,this.context.stroke()}else this.context.lineTo(e,i),this.context.stroke()},dragStart:function(t){if("drag"==this.canvasMode){this.isMove=!0;for(var e,i=1e3,n=0;n<this.coords.length;n++){var s=parseInt(this.coords[n].x*this.field_w/115),o=parseInt(this.coords[n].y*this.field_h/75),a=t.offsetX,r=t.offsetY,l=Math.sqrt(Math.pow(a-s,2)+Math.pow(r-o,2));l<i&&(i=l,e=n)}console.log("Selected index : ",e),this.selectIdx=e}else{let e=t.offsetX,i=t.offsetY;this.context.beginPath(),this.context.lineTo(e,i),this.context.stroke()}this.isDrag=!0},dragEnd:function(){"drag"==this.canvasMode&&(this.isMove=!1,this.beforeMouseX=null,this.beforeMouseY=null),this.isDrag=!1},clear:function(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},moveArc:function(){this.canvasMode="drag",this.context.strokeStyle="#00000000"},penBlack:function(){this.canvasMode="penBlack",this.context.lineCap="round",this.context.lineJoin="round",this.context.lineWidth=5,this.context.strokeStyle="#000000"},penRed:function(){this.canvasMode="penRed",this.context.lineCap="round",this.context.lineJoin="round",this.context.lineWidth=5,this.context.strokeStyle="#FF0000"},penBlue:function(){this.canvasMode="penBlue",this.context.lineCap="round",this.context.lineJoin="round",this.context.lineWidth=5,this.context.strokeStyle="#0000FF"},eraser:function(){this.canvasMode="eraser",this.context.lineCap="square",this.context.lineJoin="square",this.context.lineWidth=30,this.context.strokeStyle="#FFFFFF"}}};const j=(0,b.Z)(P,[["render",Y],["__scopeId","data-v-e5c65264"]]);var U=j,q={name:"App",components:{TitleHeader:D,CreateImage:w,CanvasField:U},data(){return{results:[]}},methods:{emitData(t){this.results=t}}};const Z=(0,b.Z)(q,[["render",a]]);var H=Z;(0,n.ri)(H).mount("#app")}},e={};function i(n){var s=e[n];if(void 0!==s)return s.exports;var o=e[n]={exports:{}};return t[n](o,o.exports,i),o.exports}i.m=t,function(){var t=[];i.O=function(e,n,s,o){if(!n){var a=1/0;for(d=0;d<t.length;d++){n=t[d][0],s=t[d][1],o=t[d][2];for(var r=!0,l=0;l<n.length;l++)(!1&o||a>=o)&&Object.keys(i.O).every((function(t){return i.O[t](n[l])}))?n.splice(l--,1):(r=!1,o<a&&(a=o));if(r){t.splice(d--,1);var c=s();void 0!==c&&(e=c)}}return e}o=o||0;for(var d=t.length;d>0&&t[d-1][2]>o;d--)t[d]=t[d-1];t[d]=[n,s,o]}}(),function(){i.d=function(t,e){for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={826:0};i.O.j=function(e){return 0===t[e]};var e=function(e,n){var s,o,a=n[0],r=n[1],l=n[2],c=0;if(a.some((function(e){return 0!==t[e]}))){for(s in r)i.o(r,s)&&(i.m[s]=r[s]);if(l)var d=l(i)}for(e&&e(n);c<a.length;c++)o=a[c],i.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return i.O(d)},n=self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))}();var n=i.O(void 0,[998],(function(){return i(4514)}));n=i.O(n)})();
//# sourceMappingURL=index.8fe788ea.js.map