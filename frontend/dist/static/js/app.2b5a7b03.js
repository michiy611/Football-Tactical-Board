(function(){"use strict";var e={3869:function(e,t,o){var n=o(9963),i=o(6252);const s=(0,i._)("div",{class:"text"},"Tactical Board",-1);function r(e,t,o,n,r,l){const u=(0,i.up)("CreateImage"),a=(0,i.up)("PlayerCircle");return(0,i.wg)(),(0,i.iD)("div",null,[s,(0,i.Wm)(u,{onMyClick:l.emitData},null,8,["onMyClick"]),(0,i.Wm)(a,{results:r.results},null,8,["results"])])}const l={class:"container"},u={class:"board"},a=["onMousedown","fill","stroke","cx","cy","r"];function c(e,t,o,n,s,r){return(0,i.wg)(),(0,i.iD)("div",l,[(0,i._)("div",u,[((0,i.wg)(),(0,i.iD)("svg",null,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(s.coords,((e,t)=>((0,i.wg)(),(0,i.iD)("circle",{key:t,onMousedown:e=>r.move(e,t),fill:e.color,stroke:s.stroke,cx:parseInt(e.x*s.field_w/115),cy:parseInt(e.y*s.field_h/75),r:s.radius},null,40,a)))),128))]))])])}var d={props:["results"],data(){return{ratio:1,dx:0,dy:0,viewport:"0 0 500 500",isMove:!1,beforeMouseX:null,beforeMouseY:null,selectIdx:0,radius:window.innerWidth/150,coords:[],stroke:"black",field_w:.6*window.innerWidth,field_h:.39*window.innerWidth}},watch:{results:function(){this.coords=this.results}},mounted(){console.log("MOUNT LISTENER ON"),console.log(this.field_w),console.log(this.field_h),document.addEventListener("mouseup",this.mouseUp),document.addEventListener("mousemove",this.mouseMove)},beforeUnmount(){console.log("MOUNT LISTENER OFF"),document.removeEventListener("mouseup",this.mouseUp),document.removeEventListener("mousemove",this.mouseMove)},methods:{move(e,t){this.isMove=!0,this.selectIdx=t,e.preventDefault()},mouseUp(e){this.isMove=!1,this.beforeMouseX=null,this.beforeMouseY=null,e.preventDefault()},mouseMove(e){if(this.isMove){var t=e.offsetX*this.ratio+this.dx,o=e.offsetY*this.ratio+this.dy,n=0,i=0;this.beforeMouseX&&this.beforeMouseY&&(n=t-this.beforeMouseX,i=o-this.beforeMouseY),this.beforeMouseX=t,this.beforeMouseY=o;var s=n+Number(this.coords[this.selectIdx].x),r=i+Number(this.coords[this.selectIdx].y);s>0&&(this.coords[this.selectIdx].x=s),r>0&&(this.coords[this.selectIdx].y=r),e.preventDefault()}}}},h=o(3744);const f=(0,h.Z)(d,[["render",c]]);var v=f,m=o(3577);const p=e=>((0,i.dD)("data-v-722c133c"),e=e(),(0,i.Cn)(),e),g={id:"app"},w={for:"input-video"},b={key:0,controls:"",id:"video"},y=["src"],M=p((()=>(0,i._)("span",null,"Capture this moment!!!",-1))),x=[M];function I(e,t,o,n,s,r){return(0,i.wg)(),(0,i.iD)("div",g,[(0,i._)("label",w,(0,m.zw)(s.isLoading?"読み込み中...":"動画を選択"),1),(0,i._)("input",{id:"input-video",type:"file",accept:"video/mp4,video/x-m4v",onChange:t[0]||(t[0]=(...e)=>r.handleFileSelect&&r.handleFileSelect(...e))},null,32),s.src?((0,i.wg)(),(0,i.iD)("video",b,[(0,i._)("source",{src:s.src,type:'video/mp4; codecs="avc1.42E01E, mp4a.40.2"'},null,8,y)])):(0,i.kq)("",!0),(0,i._)("a",{class:"btn uploadbtn",onClick:t[1]||(t[1]=e=>r.onUploadImage())},x)])}o(7658);var k=o(8945);const D="http://127.0.0.1:5000";var O={data(){return{src:null,image:[],time:0,isLoading:!1,uploadedImage:"",results:[]}},methods:{handleFileSelect(e){this.src=null,this.selected=0;const t=e.target.files[0];if(!t||!t.type.match("video/*"))return;const o=new FileReader;o.onload=e=>{this.src=e.target.result,this.isLoading=!1},o.readAsDataURL(t),this.isLoading=!0},onUploadImage(){let e=this;this.image=[];const t=document.createElement("canvas"),o=t.getContext("2d"),n=document.getElementById("video");t.width=n.videoWidth,t.height=n.videoHeight,this.time=n.currentTime,n.pause(),o.drawImage(n,0,0,n.videoWidth,n.videoHeight),this.image.push(t.toDataURL("image/png"));var i=new FormData;i.append("image",this.image),k.Z.post(`${D}/detect`,i).then((function(t){e.results=t.data.results;for(const o of e.results)console.log(o);e.$emit("my-click",e.results)}))}}};const _=(0,h.Z)(O,[["render",I],["__scopeId","data-v-722c133c"]]);var C=_,E={name:"App",components:{CreateImage:C,PlayerCircle:v},data(){return{results:[]}},methods:{emitData(e){this.results=e}}};const L=(0,h.Z)(E,[["render",r]]);var U=L;(0,n.ri)(U).mount("#app")}},t={};function o(n){var i=t[n];if(void 0!==i)return i.exports;var s=t[n]={exports:{}};return e[n](s,s.exports,o),s.exports}o.m=e,function(){var e=[];o.O=function(t,n,i,s){if(!n){var r=1/0;for(c=0;c<e.length;c++){n=e[c][0],i=e[c][1],s=e[c][2];for(var l=!0,u=0;u<n.length;u++)(!1&s||r>=s)&&Object.keys(o.O).every((function(e){return o.O[e](n[u])}))?n.splice(u--,1):(l=!1,s<r&&(r=s));if(l){e.splice(c--,1);var a=i();void 0!==a&&(t=a)}}return t}s=s||0;for(var c=e.length;c>0&&e[c-1][2]>s;c--)e[c]=e[c-1];e[c]=[n,i,s]}}(),function(){o.d=function(e,t){for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};o.O.j=function(t){return 0===e[t]};var t=function(t,n){var i,s,r=n[0],l=n[1],u=n[2],a=0;if(r.some((function(t){return 0!==e[t]}))){for(i in l)o.o(l,i)&&(o.m[i]=l[i]);if(u)var c=u(o)}for(t&&t(n);a<r.length;a++)s=r[a],o.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return o.O(c)},n=self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=o.O(void 0,[998],(function(){return o(3869)}));n=o.O(n)})();
//# sourceMappingURL=app.2b5a7b03.js.map