(function(){"use strict";var e={3239:function(e,t,o){var s=o(9963),i=o(6252);const n=(0,i._)("div",{class:"text"},"Tactical Board",-1);function r(e,t,o,s,r,u){const l=(0,i.up)("CreateImage"),a=(0,i.up)("PlayerCircle");return(0,i.wg)(),(0,i.iD)("div",null,[n,(0,i.Wm)(l,{onMyClick:u.emitData},null,8,["onMyClick"]),(0,i.Wm)(a,{results:r.results},null,8,["results"])])}const u={class:"container"},l={class:"board"},a=["onMousedown","fill","stroke","cx","cy","r"];function c(e,t,o,s,n,r){return(0,i.wg)(),(0,i.iD)("div",u,[(0,i._)("div",l,[((0,i.wg)(),(0,i.iD)("svg",null,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(n.coords,((e,t)=>((0,i.wg)(),(0,i.iD)("circle",{key:t,onMousedown:e=>r.move(e,t),fill:e.color,stroke:n.stroke,cx:parseInt(e.x/n.field_w*640),cy:parseInt(e.y/n.field_h*384),r:n.radius},null,40,a)))),128))]))])])}var d={props:["results"],data(){return{ratio:1,dx:0,dy:0,viewport:"0 0 500 500",isMove:!1,beforeMouseX:null,beforeMouseY:null,selectIdx:0,radius:window.innerWidth/90,coords:[],stroke:"black",field_w:.6*window.innerWidth,field_h:.4*window.innerWidth}},watch:{results:function(){this.coords=this.results}},mounted(){console.log("MOUNT LISTENER ON"),document.addEventListener("mouseup",this.mouseUp),document.addEventListener("mousemove",this.mouseMove)},beforeUnmount(){console.log("MOUNT LISTENER OFF"),document.removeEventListener("mouseup",this.mouseUp),document.removeEventListener("mousemove",this.mouseMove)},methods:{move(e,t){this.isMove=!0,this.selectIdx=t,e.preventDefault()},mouseUp(e){this.isMove=!1,this.beforeMouseX=null,this.beforeMouseY=null,e.preventDefault()},mouseMove(e){if(this.isMove){var t=e.offsetX*this.ratio+this.dx,o=e.offsetY*this.ratio+this.dy,s=0,i=0;this.beforeMouseX&&this.beforeMouseY&&(s=t-this.beforeMouseX,i=o-this.beforeMouseY),this.beforeMouseX=t,this.beforeMouseY=o;var n=s+Number(this.coords[this.selectIdx].x),r=i+Number(this.coords[this.selectIdx].y);n>0&&(this.coords[this.selectIdx].x=n),r>0&&(this.coords[this.selectIdx].y=r),e.preventDefault()}}}},h=o(3744);const f=(0,h.Z)(d,[["render",c]]);var v=f,m=o(3577);const p=e=>((0,i.dD)("data-v-69109f81"),e=e(),(0,i.Cn)(),e),g={id:"app"},w={for:"input-video"},b={key:0,controls:"",id:"video"},y=["src"],M=["src"],x=p((()=>(0,i._)("h2",null,"Results",-1)));function I(e,t,o,s,n,r){return(0,i.wg)(),(0,i.iD)("div",g,[(0,i._)("label",w,(0,m.zw)(n.isLoading?"読み込み中...":"動画を選択"),1),(0,i._)("input",{id:"input-video",type:"file",accept:"video/mp4,video/x-m4v",onChange:t[0]||(t[0]=(...e)=>r.handleFileSelect&&r.handleFileSelect(...e))},null,32),n.src?((0,i.wg)(),(0,i.iD)("video",b,[(0,i._)("source",{src:n.src,type:'video/mp4; codecs="avc1.42E01E, mp4a.40.2"'},null,8,y)])):(0,i.kq)("",!0),(0,i._)("img",{class:"image",src:n.image},null,8,M),(0,i._)("button",{class:"uploadbtn",onClick:t[1]||(t[1]=e=>r.onUploadImage())},"このシーンを再現"),x])}o(7658);var k=o(8945);const D="http://127.0.0.1:5000";var O={data(){return{src:null,image:[],time:0,isLoading:!1,uploadedImage:"",results:[]}},methods:{handleFileSelect(e){this.src=null,this.selected=0;const t=e.target.files[0];if(!t||!t.type.match("video/*"))return;const o=new FileReader;o.onload=e=>{this.src=e.target.result,this.isLoading=!1},o.readAsDataURL(t),this.isLoading=!0},onUploadImage(){let e=this;this.image=[];const t=document.createElement("canvas"),o=t.getContext("2d"),s=document.getElementById("video");t.width=s.videoWidth,t.height=s.videoHeight,this.time=s.currentTime,s.pause(),o.drawImage(s,0,0,s.videoWidth,s.videoHeight),this.image.push(t.toDataURL("image/png"));var i=new FormData;i.append("image",this.image),k.Z.post(`${D}/detect`,i).then((function(t){e.results=t.data.results;for(const o of e.results)console.log(o);e.$emit("my-click",e.results)}))}}};const _=(0,h.Z)(O,[["render",I],["__scopeId","data-v-69109f81"]]);var E=_,C={name:"App",components:{CreateImage:E,PlayerCircle:v},data(){return{results:[]}},methods:{emitData(e){this.results=e}}};const L=(0,h.Z)(C,[["render",r]]);var U=L;(0,s.ri)(U).mount("#app")}},t={};function o(s){var i=t[s];if(void 0!==i)return i.exports;var n=t[s]={exports:{}};return e[s](n,n.exports,o),n.exports}o.m=e,function(){var e=[];o.O=function(t,s,i,n){if(!s){var r=1/0;for(c=0;c<e.length;c++){s=e[c][0],i=e[c][1],n=e[c][2];for(var u=!0,l=0;l<s.length;l++)(!1&n||r>=n)&&Object.keys(o.O).every((function(e){return o.O[e](s[l])}))?s.splice(l--,1):(u=!1,n<r&&(r=n));if(u){e.splice(c--,1);var a=i();void 0!==a&&(t=a)}}return t}n=n||0;for(var c=e.length;c>0&&e[c-1][2]>n;c--)e[c]=e[c-1];e[c]=[s,i,n]}}(),function(){o.d=function(e,t){for(var s in t)o.o(t,s)&&!o.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};o.O.j=function(t){return 0===e[t]};var t=function(t,s){var i,n,r=s[0],u=s[1],l=s[2],a=0;if(r.some((function(t){return 0!==e[t]}))){for(i in u)o.o(u,i)&&(o.m[i]=u[i]);if(l)var c=l(o)}for(t&&t(s);a<r.length;a++)n=r[a],o.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return o.O(c)},s=self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=o.O(void 0,[998],(function(){return o(3239)}));s=o.O(s)})();
//# sourceMappingURL=app.ea270141.js.map